
rules_version = '2';

service cloud.firestore {
  match /databases/{database}/documents {

    // --- Website Content ---
    // This collection stores the public-facing content for the marketing website.
    // It is safe for anyone to read this content.
    // For this prototype, writes are also open to allow the admin panel to function
    // without real user authentication. In a production app, this should be restricted
    // to authenticated admins: `allow write: if request.auth.token.role == 'admin';`
    match /website_content/{document=**} {
      allow read, write: if true;
    }

    // --- School Management Collections (DOS & Teacher Portals) ---
    // For prototype purposes, these collections are open for reads and writes
    // to allow the DOS and Teacher portals to function without complex authentication setup.
    // IN A PRODUCTION ENVIRONMENT, THESE RULES MUST BE SECURED.
    // Example secure rule: `allow read, write: if request.auth != null;`
    match /teachers/{teacherId} {
      allow read, write: if true;
    }
    match /students/{studentId} {
      allow read, write: if true;
    }
    match /classes/{classId} {
      allow read, write: if true;
    }
    match /subjects/{subjectId} {
      allow read, write: if true;
    }
    match /terms/{termId} {
      allow read, write: if true;
    }
    match /exams/{examId} {
      allow read, write: if true;
    }
    match /gradingPolicies/{policyId} {
      allow read, write: if true;
    }
    match /markSubmissions/{submissionId} {
      allow read, write: if true;
    }
     match /attendance/{attendanceId} {
      allow read, write: if true;
    }

    // --- General Settings ---
    // Allow anyone to read/write settings for the prototype.
    // In production, restrict writes to admins.
    match /settings/{settingId} {
      allow read, write: if true;
    }
  }
}
